# Mastera å¹³å°

> è¿æ¥åˆ›ä½œè€…å’Œç”¨æˆ·çš„ç°ä»£åˆ›ä½œè€…å†…å®¹å¹³å°ï¼Œæä¾›ä¸°å¯Œçš„æ•°å­—å†…å®¹äº¤æ˜“å’Œç¤¾åŒºäº’åŠ¨ä½“éªŒã€‚

## ğŸŒŸ é¡¹ç›®æ¦‚è¿°

Mastera å¹³å°æ˜¯ä¸€ä¸ªåŸºäº Next.js æ„å»ºçš„å…¨æ ˆ Web åº”ç”¨ç¨‹åºï¼Œæ—¨åœ¨ä¸ºåˆ›ä½œè€…å’Œç”¨æˆ·æä¾›å®Œæ•´çš„æ•°å­—å†…å®¹ç”Ÿæ€ç³»ç»Ÿã€‚è¯¥å¹³å°æ”¯æŒä¸Šä¼ ã€è´­ä¹°å’Œä¸‹è½½å„ç§å†…å®¹ç±»å‹ï¼Œé€šè¿‡ç§¯åˆ†ç³»ç»Ÿå’Œç¤¾åŒºåŠŸèƒ½å¢å¼ºç”¨æˆ·å‚ä¸åº¦ã€‚

## ğŸ§¾ ç‰ˆæœ¬è®°å½•

### v0.2.0 â€” 2025-11-28 UI é‡æ„ä¸è§†è§‰å‡çº§

- å…¨é¢é‡æ„ UIï¼Œé‡‡ç”¨åŠé€æ˜ç»ç’ƒæ‹Ÿæ€ä¸æŸ”å’Œæ¨¡ç³Šï¼Œå‚è€ƒ https://www.anime.com/
- æ›¿æ¢æ—§ shadcn æ¨¡æ¿å¸ƒå±€ï¼Œç»Ÿä¸€å¡ç‰‡/é¢æ¿æ ·å¼ä¸é—´è·
- å“åº”å¼ç­–ç•¥ä¿æŒ `md` æ–­ç‚¹ï¼Œä¼˜åŒ–ç§»åŠ¨ç«¯æ ·å¼

### v0.1.0 â€” 2025-11-13 æ³¨å†Œç™»å½•ã€è§†é¢‘ä¸Šä¼ å‘å¸ƒæŸ¥çœ‹ç­‰åŸºç¡€æµç¨‹

- å®Œæˆæ ¸å¿ƒæ¶æ„ï¼šNext.js 15ã€TypeScriptã€Tailwind CSS 4
- å¼•å…¥å¹¶åº”ç”¨ shadcn/uiï¼Œå»ºç«‹åŸºç¡€ UI ä½“ç³»ä¸å¤ç”¨ç»„ä»¶
- é›†æˆ Better Authï¼Œæ”¯æŒæ³¨å†Œã€ç™»å½•ã€é‚®ç®±éªŒè¯ä¸å¯†ç é‡ç½®
- å»ºç«‹ Prisma æ•°æ®æ¨¡å‹ï¼ˆUserã€Workã€Purchaseã€Review ç­‰ï¼‰å¹¶æ¥é€š SQLite å¼€å‘ç¯å¢ƒ
- æ‰“é€šåª’ä½“é“¾è·¯ï¼šMux ä¸Šä¼ ã€èµ„äº§æŸ¥è¯¢ä¸æ’­æ”¾é¡µ
- ç»Ÿä¸€è¯·æ±‚å°è£…ï¼šä½¿ç”¨ `src/lib/request.ts`ï¼Œæ ‡å‡†åŒ–è¿”å›ç»“æ„ï¼ˆ`apiSuccess`/`apiFailure`ï¼‰
- åˆç‰ˆé¡µé¢å°±ç»ªï¼šç™»å½•/æ³¨å†Œã€æ¢ç´¢ã€å†å²ã€è®¢é˜…ã€æ’­æ”¾åˆ—è¡¨ã€ä½œå“è¯¦æƒ…ã€åˆ›ä½œè€…ä¸Šä¼ ä¸ç¼–è¾‘ã€ç”¨æˆ·ä¸»é¡µ
- å»ºç«‹ API è·¯ç”±ï¼šworksã€playlistsã€searchã€historyã€sectionã€subscriptionsã€users ç­‰

### âœ… å·²å®ŒæˆåŠŸèƒ½

- **èº«ä»½è®¤è¯ç³»ç»Ÿ** - Better Auth ç™»å½•ã€æ³¨å†Œã€é‚®ç®±éªŒè¯
- **æ•°æ®åº“æ¶æ„** - Prisma å®Œæ•´æ•°æ®æ¨¡å‹ï¼ˆç”¨æˆ·ã€ä½œå“ã€è´­ä¹°ã€è¯„è®ºï¼‰
- **åˆ›ä½œè€…ä»ªè¡¨æ¿** - ä½œå“ç®¡ç†ã€ç»Ÿè®¡å’Œæ”¶ç›Šæ¦‚è§ˆ
- **å†…å®¹ä¸Šä¼ ** - æ–‡ä»¶ä¸Šä¼ ç³»ç»Ÿï¼Œæ”¯æŒå…ƒæ•°æ®å’Œåˆ†ç±»
- **å†…å®¹æŸ¥çœ‹** - è§†é¢‘æ’­æ”¾å™¨ã€ä½œå“è¯¦æƒ…å’Œäº’åŠ¨åŠŸèƒ½
- **æ¢ç´¢é¡µé¢** - åˆ†ç±»ç­›é€‰å’Œå†…å®¹å‘ç°
- **UI ç»„ä»¶** - shadcn/ui ç»„ä»¶åº“ï¼Œè®¾è®¡ä¸€è‡´

## ğŸ›  æŠ€æœ¯æ ˆ

### å‰ç«¯

- **Next.js 15** - å¸¦ App Router çš„ React å…¨æ ˆæ¡†æ¶
- **React 19** - ç”¨æˆ·ç•Œé¢åº“
- **Tailwind CSS 4** - å®ç”¨ä¼˜å…ˆçš„ CSS æ¡†æ¶
- **shadcn/ui** - åŸºäº Radix UI çš„ç°ä»£ç»„ä»¶åº“
- **Framer Motion** - åŠ¨ç”»åº“
- **Lucide React** - å›¾æ ‡åº“

### åç«¯

- **Better Auth** - èº«ä»½è®¤è¯ç³»ç»Ÿ
- **Prisma** - æ•°æ®åº“ ORM
- **SQLite** - å¼€å‘æ•°æ®åº“
- **Supabase** - ç”Ÿäº§æ•°æ®åº“å’Œå­˜å‚¨
- **Resend** - é‚®ä»¶æœåŠ¡
- **Sentry** - é”™è¯¯ç›‘æ§ä¸æ—¥å¿—ä¸ŠæŠ¥

### åª’ä½“å’Œä¸Šä¼ 

- **Mux** - è§†é¢‘å¤„ç†å’Œæµåª’ä½“

### å¼€å‘å·¥å…·

- **TypeScript** - ç±»å‹å®‰å…¨
- **ESLint** - ä»£ç æ£€æŸ¥
- **PNPM** - åŒ…ç®¡ç†å™¨

## ğŸ“¦ å®‰è£…æŒ‡å—

### å‰ç½®è¦æ±‚

- Node.js 18+
- PNPM åŒ…ç®¡ç†å™¨
- Git

### å®‰è£…æ­¥éª¤

1. **å…‹éš†ä»“åº“**

   ```bash
   git clone https://github.com/yourusername/mastera-platform.git
   cd mastera-platform
   ```

2. **å®‰è£…ä¾èµ–**

   ```bash
   pnpm install
   ```

3. **ç¯å¢ƒé…ç½®**

   åœ¨æ ¹ç›®å½•åˆ›å»º `.env.local` æ–‡ä»¶ï¼š

   ```env
   # æ•°æ®åº“
   DATABASE_URL="your_database_url"

   # Supabase
   NEXT_PUBLIC_SUPABASE_URL="your_supabase_url"

   # Sentry ç›‘æ§
   # å¼€å¯/å…³é—­ Sentry ä¸ŠæŠ¥ã€‚
   # å¦‚æœæœªè®¾ç½®ï¼Œå¼€å‘ç¯å¢ƒé»˜è®¤å…³é—­ï¼Œç”Ÿäº§ç¯å¢ƒé»˜è®¤å¼€å¯ã€‚
   # è®¾ç½®ä¸º 'true' å¼ºåˆ¶å¼€å¯ï¼Œ'false' å¼ºåˆ¶å…³é—­ã€‚
   NEXT_PUBLIC_ENABLE_SENTRY="false"

   NEXT_PUBLIC_SUPABASE_ANON_KEY="your_supabase_anon_key"
   SUPABASE_SERVICE_ROLE_KEY="your_service_role_key"

   # Better Auth
   BETTER_AUTH_SECRET="your_auth_secret"

   # Resend (é‚®ä»¶æœåŠ¡)
   RESEND_API_KEY="your_resend_api_key"

   # Mux (è§†é¢‘å¤„ç†)
   MUX_TOKEN_ID="your_mux_token_id"
   MUX_TOKEN_SECRET="your_mux_token_secret"
   ```

4. **æ•°æ®åº“è®¾ç½®**

   ```bash
   # ç”Ÿæˆ Prisma å®¢æˆ·ç«¯
   pnpm dbgenerate

   # è¿è¡Œæ•°æ®åº“è¿ç§»
   pnpm dbmigrate

   # (å¯é€‰) æ‰“å¼€ Prisma Studio
   pnpm dbstudio
   ```

5. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**

   ```bash
   pnpm dev
   ```

   åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ [http://localhost:3000](http://localhost:3000)ã€‚

## ğŸ§­ ç°æœ‰é¡µé¢ä¸€è§ˆ

å½“å‰ä»“åº“ä¸­çš„é¡µé¢ï¼ˆåŸºäº App Routerï¼‰ï¼š

- `/` é¦–é¡µ
- `/auth/login` ç™»å½•
- `/auth/register` æ³¨å†Œ
- `/auth/forgot-password` å¿˜è®°å¯†ç 
- `/auth/reset-password` é‡ç½®å¯†ç 
- `/auth/verify-email/[email]` é‚®ç®±éªŒè¯
- `/creator` åˆ›ä½œè€…ä»ªè¡¨æ¿
- `/creator/upload` åˆ›ä½œè€…å†…å®¹ä¸Šä¼ 
- `/creator/edit/[id]` åˆ›ä½œè€…å†…å®¹ç¼–è¾‘
- `/explore` å†…å®¹æ¢ç´¢/å‘ç°
- `/history` æµè§ˆå†å²
- `/playlists` æ’­æ”¾åˆ—è¡¨
- `/playlists/[id]` æ’­æ”¾åˆ—è¡¨è¯¦æƒ…
- `/profile` ä¸ªäººèµ„æ–™
- `/search` æœç´¢
- `/section` åˆ†åŒº/åˆ†ç±»
- `/subscriptions` è®¢é˜…ä¸ä¼šå‘˜
- `/content/[id]` ä½œå“è¯¦æƒ…
- `/user/[id]` ç”¨æˆ·ä¸»é¡µ
- `/admin` ç®¡ç†é¡µé¢
- `/subscriptions` è®¢é˜…ä¸ä¼šå‘˜ï¼ˆsrc/app/subscriptions/page.jsï¼‰
- `/content/[id]` ä½œå“è¯¦æƒ…ï¼ˆåŠ¨æ€è·¯ç”±ï¼Œsrc/app/content/[id]/page.jsï¼‰
- `/section/[id]` åˆ†åŒº/åˆ†ç±»è¯¦æƒ…ï¼ˆåŠ¨æ€è·¯ç”±ï¼Œsrc/app/section/[id]/page.jsï¼‰
- `/user/[id]` ç”¨æˆ·ä¸»é¡µï¼ˆåŠ¨æ€è·¯ç”±ï¼Œsrc/app/user/[id]/page.jsï¼‰

## ğŸ“‹ å¼€å‘å¾…åŠäº‹é¡¹åˆ—è¡¨

### âœ… å·²å®ŒæˆåŠŸèƒ½

- **èº«ä»½è®¤è¯ç³»ç»Ÿ**ï¼šBetter Auth å®ç°ï¼ŒåŒ…å«ç™»å½•ã€æ³¨å†Œå’Œé‚®ç®±éªŒè¯
- **æ•°æ®åº“æ¶æ„**ï¼šPrisma è®¾ç½®ï¼ŒåŒ…å«ç”¨æˆ·ã€ä½œå“ã€è´­ä¹°å’Œè¯„è®ºæ¨¡å‹
- **åˆ›ä½œè€…ä»ªè¡¨æ¿**ï¼šæ„å»ºä½œå“ç®¡ç†å’Œåˆ†æåŠŸèƒ½
- **å†…å®¹ä¸Šä¼ **ï¼šæ–‡ä»¶å¤„ç†å’Œå…ƒæ•°æ®å¤„ç†ç³»ç»Ÿ
- **å†…å®¹æŸ¥çœ‹**ï¼šè§†é¢‘æ’­æ”¾å™¨å’Œä½œå“è¯¦æƒ…é¡µé¢
- **æ¢ç´¢é¡µé¢**ï¼šå†…å®¹å‘ç°ï¼Œæ”¯æŒåˆ†ç±»ç­›é€‰
- **shadcn/ui è®¾ç½®**ï¼šä¸€è‡´çš„è®¾è®¡ç³»ç»Ÿå’Œç»„ä»¶åº“

### ğŸ”¥ é«˜ä¼˜å…ˆçº§ï¼ˆè¿›è¡Œä¸­ï¼‰

- **ç”¨æˆ·èµ„æ–™**ï¼šå®ç°ç”¨æˆ·ä¸ªäººèµ„æ–™é¡µé¢ï¼ŒåŒ…å«ä½œå“é›†å’Œç»Ÿè®¡ä¿¡æ¯
- **Mastera ç§¯åˆ†**ï¼šæ„å»ºç§¯åˆ†ç³»ç»Ÿï¼ŒåŒ…å«è·å–å’Œæ¶ˆè´¹æœºåˆ¶
- **ä¼šå‘˜ç­‰çº§**ï¼šå®ç°è®¢é˜…ç³»ç»Ÿï¼ˆå…è´¹ç‰ˆ/åˆ›ä½œè€…+/è‰ºæœ¯åœˆ/VIPï¼‰
- **æ”¯ä»˜å¤„ç†**ï¼šé›†æˆæ”¯ä»˜ç³»ç»Ÿï¼Œæ”¯æŒå†…å®¹è´­ä¹°å’Œä¼šå‘˜å‡çº§
- **ç”Ÿäº§éƒ¨ç½²**ï¼šé…ç½®éƒ¨ç½²æµç¨‹å’Œç”Ÿäº§ç¯å¢ƒ

### ğŸ“‹ ä¸­ç­‰ä¼˜å…ˆçº§ï¼ˆå·²è®¡åˆ’ï¼‰

- **ç¤¾åŒºåŠŸèƒ½**ï¼šæ„å»ºè¯„è®ºã€ç‚¹èµã€å…³æ³¨å’Œåˆ›ä½œè€…åœˆå­
- **é«˜çº§æœç´¢**ï¼šå®ç°æœç´¢åŠŸèƒ½ï¼ŒåŒ…å«ç­›é€‰å’Œæ¨è
- **é€šçŸ¥ç³»ç»Ÿ**ï¼šæ·»åŠ ç”¨æˆ·äº’åŠ¨å’Œæ›´æ–°é€šçŸ¥
- **ç§»åŠ¨ç«¯ä¼˜åŒ–**ï¼šå¢å¼ºç§»åŠ¨è®¾å¤‡çš„å“åº”å¼è®¾è®¡
- **æ€§èƒ½ä¼˜åŒ–**ï¼šå®ç°ç¼“å­˜ã€æ‡’åŠ è½½å’Œ CDN é›†æˆ
- **æµ‹è¯•æ¡†æ¶**ï¼šè®¾ç½®ç»¼åˆæµ‹è¯•å¥—ä»¶

### ğŸ”® ä½ä¼˜å…ˆçº§ï¼ˆæœªæ¥ï¼‰

- **ç®¡ç†å‘˜é¢æ¿**ï¼šåˆ›å»ºå¹³å°ç®¡ç†çš„ç®¡ç†é¢æ¿

## ğŸ— ç³»ç»Ÿæ¶æ„

### ç”¨æˆ·ç³»ç»Ÿ

- **èº«ä»½è®¤è¯**ï¼šBetter Auth é‚®ç®±éªŒè¯
- **ç”¨æˆ·èµ„æ–™**ï¼šä¸ªäººä¿¡æ¯ã€ä½œå“é›†ã€ç»Ÿè®¡æ•°æ®
- **è´¦æˆ·ç®¡ç†**ï¼šè®¾ç½®ã€åå¥½ã€å®‰å…¨

### å†…å®¹ç³»ç»Ÿ

- **ä¸Šä¼ ç®¡ç†**ï¼šå¤šæ ¼å¼æ–‡ä»¶æ”¯æŒï¼ŒMux å¤„ç†
- **å†…å®¹ç»„ç»‡**ï¼šåˆ†ç±»ã€æ ‡ç­¾ã€å…ƒæ•°æ®
- **è®¿é—®æ§åˆ¶**ï¼šå…¬å¼€ã€ä»˜è´¹ã€ä¼šå‘˜ä¸“äº«å†…å®¹

### ç¤¾åŒºç³»ç»Ÿ

- **ç¤¾äº¤åŠŸèƒ½**ï¼šè¯„è®ºã€ç‚¹èµã€å…³æ³¨
- **åˆ›ä½œè€…åœˆå­**ï¼šåˆ›ä½œè€…ä¸“å±ç¤¾åŒº
- **ç”¨æˆ·äº’åŠ¨**ï¼šç§ä¿¡ã€é€šçŸ¥

### ç§¯åˆ†å¥–åŠ±ç³»ç»Ÿ

- **Mastera ç§¯åˆ†**ï¼šå¹³å°è´§å¸ï¼Œå¥–åŠ±ç”¨æˆ·å‚ä¸
- **è·å–æœºåˆ¶**ï¼šæ¯æ—¥ç­¾åˆ°ã€å†…å®¹äº’åŠ¨ã€æ¨èå¥–åŠ±
- **æ¶ˆè´¹é€‰é¡¹**ï¼šä»˜è´¹å†…å®¹è®¿é—®ã€ä¸“å±åŠŸèƒ½

### åˆ›ä½œè€…ç³»ç»Ÿ

- **å˜ç°å·¥å…·**ï¼šå†…å®¹é”€å”®ã€è®¢é˜…ç­‰çº§
- **åˆ†æé¢æ¿**ï¼šæ”¶å…¥è·Ÿè¸ªã€å—ä¼—æ´å¯Ÿ
- **åˆ›ä½œè€…æ”¯æŒ**ï¼šèµ„æºã€æŒ‡å—ã€ç¤¾åŒº

### å¢é•¿è¥é”€ç³»ç»Ÿ

- **æ¨èè®¡åˆ’**ï¼šç”¨æˆ·è·å–æ¿€åŠ±
- **å†…å®¹å‘ç°**ï¼šæ¨èç®—æ³•
- **SEO ä¼˜åŒ–**ï¼šæœç´¢å¼•æ“å¯è§æ€§

## ğŸ”§ å¼€å‘æŒ‡å—

### ä»£ç è§„èŒƒ (Code Standards)

#### 1. é€šç”¨è§„èŒƒ

- **è¯­è¨€**: ä½¿ç”¨ TypeScript ç¡®ä¿ç±»å‹å®‰å…¨,éµå¾ªè·¯å¾„åˆ«å `@/*` æŒ‡å‘ `./src/*`
- **åŒ…ç®¡ç†å™¨**: ç»Ÿä¸€ä½¿ç”¨ PNPM è¿›è¡ŒåŒ…ç®¡ç†
- **å¼€å‘å·¥å…·**: éµå¾ª ESLint å’Œ Prettier é…ç½®ä¿è¯ä»£ç è´¨é‡
- **ç•Œé¢è¯­è¨€**: ç•Œé¢æ–‡æœ¬ä½¿ç”¨è‹±è¯­,ä»£ç æ³¨é‡Šå¯ä½¿ç”¨ä¸­æ–‡è¯´æ˜å¤æ‚é€»è¾‘

#### 2. æ–‡ä»¶å’Œå‘½åè§„èŒƒ

| ç±»å‹ | è§„èŒƒ | ç¤ºä¾‹ |
|------|------|------|
| æ–‡ä»¶å | é©¼å³°å¼ (camelCase) æˆ– å¸•æ–¯å¡å¼ (PascalCase) | `LoginForm.tsx`, `useAuth.tsx`, `request.ts` |
| ç»„ä»¶å | å¸•æ–¯å¡å¼ (PascalCase) | `AuthProvider`, `CustomSidebar`, `VideoPlayer` |
| å‡½æ•°/å˜é‡ | é©¼å³°å¼ (camelCase) | `getUserProfile`, `isLoading`, `videoUrl` |
| å¸¸é‡ | å¤§å†™è›‡å½¢ (UPPER_SNAKE_CASE) | `MAX_FILE_SIZE`, `API_BASE_URL` |
| ç±»å‹/æ¥å£ | å¸•æ–¯å¡å¼ (PascalCase) | `ApiResponse<T>`, `UserProfile`, `WorkMetadata` |
| æ•°æ®åº“è¡¨/å­—æ®µ | è›‡å½¢å‘½å (snake_case) | `user`, `work_likes`, `created_at` |

#### 3. å‰ç«¯å¼€å‘è§„èŒƒ

**React ç»„ä»¶**
- ä¼˜å…ˆä½¿ç”¨å‡½æ•°ç»„ä»¶,é¿å…ç±»ç»„ä»¶
- ä½¿ç”¨ `'use client'` æŒ‡ä»¤æ ‡è®°å®¢æˆ·ç«¯ç»„ä»¶
- è‡ªå®šä¹‰ Hook å‘½åä»¥ `use` å¼€å¤´ (å¦‚ `useAuth`, `useWorks`)
- ç»„ä»¶æ–‡ä»¶ç»“æ„: å¯¼å…¥ â†’ ç±»å‹å®šä¹‰ â†’ ç»„ä»¶å®ç° â†’ å¯¼å‡º

**æ ·å¼è§„èŒƒ**
- **Tailwind CSS ä¼˜å…ˆ**: ä½¿ç”¨ Tailwind utility classes
- **å“åº”å¼è®¾è®¡**: ä»…ä½¿ç”¨ `md` breakpoint (é¿å…ä½¿ç”¨ sm/lg/xl)
- **å…¨å±€ç±»**: é¡µé¢å¸ƒå±€ä½¿ç”¨ `.page-container` ç±» (å®šä¹‰åœ¨ [src/app/globals.css](src/app/globals.css))
- **CSS å˜é‡**: ä½¿ç”¨ `--color-*`, `--shadow-*` ç­‰è‡ªå®šä¹‰å±æ€§
- **UI ç»„ä»¶**: ä¼˜å…ˆä½¿ç”¨ shadcn/ui ç»„ä»¶åº“,ä½¿ç”¨å‰æŸ¥é˜… [shadcn/ui æ–‡æ¡£](https://ui.shadcn.com)

**å›¾æ ‡å’Œèµ„æº**
- ä½¿ç”¨ Lucide React å›¾æ ‡åº“,é¿å…ç›´æ¥ä½¿ç”¨ emoji
- å›¾æ ‡ç»„ä»¶: `import { IconName } from 'lucide-react'`

#### 4. åç«¯å¼€å‘è§„èŒƒ

**API è·¯ç”±è§„èŒƒ**
- è·¯å¾„: `src/app/api/[module]/route.ts`
- HTTP æ–¹æ³•: ä½¿ç”¨æ ‡å‡† REST åŠ¨è¯ (GET, POST, PUT, PATCH, DELETE)
- å“åº”æ ¼å¼: **å¿…é¡»**ä½¿ç”¨ç»Ÿä¸€çš„ API å“åº”ç±»å‹

**ç»Ÿä¸€ API å“åº”æ ¼å¼** ([src/contracts/types/common.ts](src/contracts/types/common.ts))

```typescript
// æˆåŠŸå“åº”
{
  success: true,
  data: T,
  error: null
}

// å¤±è´¥å“åº”
{
  success: false,
  data: null,
  error: {
    code: 'ERROR_CODE',      // UNAUTHORIZED | FORBIDDEN | NOT_FOUND | VALIDATION_FAILED | CONFLICT | INTERNAL_ERROR
    message: 'Error message',
    details?: any
  }
}
```

**ä½¿ç”¨è¾…åŠ©å‡½æ•°**
```typescript
import { apiSuccess, apiFailure } from '@/contracts/types/common'

// æˆåŠŸ
return NextResponse.json(apiSuccess(data))

// å¤±è´¥
return NextResponse.json(
  apiFailure('NOT_FOUND', 'User not found'),
  { status: 404 }
)
```

#### 5. ç»Ÿä¸€è¯·æ±‚å°è£…

**ç¦æ­¢ç›´æ¥ä½¿ç”¨ fetch**,å¿…é¡»ä½¿ç”¨ [src/lib/request.ts](src/lib/request.ts) çš„å°è£…:

```typescript
import { request } from '@/lib/request'

// GET è¯·æ±‚
const result = await request.get<User>('/api/users/me')

// POST è¯·æ±‚
const result = await request.post<Work>('/api/works', {
  title: 'My Work',
  description: 'Description'
})

// ä¸æ˜¾ç¤ºé”™è¯¯æç¤º
const result = await request.get('/api/data', {}, {
  showErrorToast: false,
  throwOnError: false
})
```

**è¯·æ±‚é€‰é¡¹**
- `showErrorToast`: æ˜¯å¦æ˜¾ç¤ºé”™è¯¯æç¤º (é»˜è®¤ `true`)
- `throwOnError`: æ˜¯å¦æŠ›å‡ºé”™è¯¯ (é»˜è®¤ `true`)
- `parseJson`: æ˜¯å¦è‡ªåŠ¨è§£æ JSON (é»˜è®¤ `true`)

#### 6. æ•°æ®éªŒè¯å’Œç±»å‹å®‰å…¨

- **Zod éªŒè¯**: ä½¿ç”¨ Zod è¿›è¡Œæ•°æ®éªŒè¯å’Œç±»å‹æ¨å¯¼
- **Prisma ç±»å‹**: åˆ©ç”¨ Prisma ç”Ÿæˆçš„ç±»å‹ç¡®ä¿æ•°æ®åº“æ“ä½œç±»å‹å®‰å…¨
- **API Contract**: å®šä¹‰ API è¾“å…¥è¾“å‡ºç±»å‹åœ¨ `src/contracts/` ç›®å½•

```typescript
import { z } from 'zod'

const CreateWorkSchema = z.object({
  title: z.string().min(1).max(200),
  description: z.string().optional(),
  price: z.number().min(0)
})

type CreateWorkInput = z.infer<typeof CreateWorkSchema>
```

#### 7. é‚®ç®±å¤„ç†è§„èŒƒ

**é‡è¦**: æ‰€æœ‰é‚®ç®±å¤„ç†å¿…é¡»è½¬æ¢ä¸ºå°å†™

```typescript
// âœ… æ­£ç¡®
const email = userInput.trim().toLowerCase()
const user = await prisma.user.findUnique({
  where: { email: email.toLowerCase() }
})

// âŒ é”™è¯¯
const user = await prisma.user.findUnique({
  where: { email: userInput }  // æœªè½¬æ¢å°å†™
})
```

#### 8. é”™è¯¯å¤„ç†å’Œæ—¥å¿—

**Sentry é›†æˆ**
- å¼€å‘ç¯å¢ƒ: é»˜è®¤å…³é—­ (å¯é€šè¿‡ `NEXT_PUBLIC_ENABLE_SENTRY=true` å¼ºåˆ¶å¼€å¯)
- ç”Ÿäº§ç¯å¢ƒ: é»˜è®¤å¼€å¯ (å¯é€šè¿‡ `NEXT_PUBLIC_ENABLE_SENTRY=false` å¼ºåˆ¶å…³é—­)
- è‡ªåŠ¨ä¸ŠæŠ¥: æ‰€æœ‰ API é”™è¯¯ä¼šè‡ªåŠ¨ä¸ŠæŠ¥åˆ° Sentry ([src/lib/request.ts:68-80](src/lib/request.ts#L68-L80))

**ç”¨æˆ·åé¦ˆ**
- ä½¿ç”¨ `sonner` åº“æ˜¾ç¤º Toast é€šçŸ¥
- é”™è¯¯æ¶ˆæ¯åº”ç®€æ´æ˜äº†,æä¾›ç”¨æˆ·å¯æ“ä½œçš„å»ºè®®

```typescript
import { toast } from 'sonner'

toast.success('Work published successfully')
toast.error('Failed to upload file')
toast.info('Processing video...')
```

#### 9. æ ¼å¼åŒ–è§„åˆ™ (Prettier)

```json
{
  "semi": false,              // ä¸ä½¿ç”¨åˆ†å·
  "trailingComma": "es5",     // ES5 å…¼å®¹çš„å°¾é€—å·
  "singleQuote": true,        // ä½¿ç”¨å•å¼•å·
  "tabWidth": 2,              // 2 ç©ºæ ¼ç¼©è¿›
  "useTabs": false,           // ä½¿ç”¨ç©ºæ ¼è€Œé Tab
  "bracketSpacing": true,     // å¯¹è±¡èŠ±æ‹¬å·ç©ºæ ¼
  "endOfLine": "lf"           // Unix æ¢è¡Œç¬¦
}
```

#### 10. ESLint è§„åˆ™

```javascript
// ç¦ç”¨çš„è§„åˆ™
"react/no-unescaped-entities": "off",      // å…è®¸æœªè½¬ä¹‰çš„å¼•å·
"@next/next/no-img-element": "off",        // å…è®¸ä½¿ç”¨ <img> æ ‡ç­¾
"react-hooks/exhaustive-deps": "off"       // ä¸å¼ºåˆ¶ Hook ä¾èµ–æ£€æŸ¥
```

### ğŸ“ å¼€å‘å·¥ä½œæµ (SOP)

#### 1. å¼€å§‹å¼€å‘

```bash
# 1. æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# 2. å®‰è£…ä¾èµ–
pnpm install

# 3. ç”Ÿæˆ Prisma å®¢æˆ·ç«¯
pnpm dbgen

# 4. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm dev
```

#### 2. æ·»åŠ æ–°åŠŸèƒ½

**æ­¥éª¤**:
1. **åˆ›å»ºåŠŸèƒ½åˆ†æ”¯**: `git checkout -b feature/your-feature-name`
2. **è®¾è®¡ API æ¥å£**: åœ¨ `src/contracts/` ä¸­å®šä¹‰ç±»å‹
3. **æ•°æ®åº“å˜æ›´**: ä¿®æ”¹ `prisma/schema.prisma` å¹¶è¿è¡Œ `pnpm dbpush`
4. **å®ç° API è·¯ç”±**: åœ¨ `src/app/api/` ä¸­åˆ›å»ºè·¯ç”±
5. **åˆ›å»ºå‰ç«¯ç»„ä»¶**: åœ¨ `src/components/` ä¸­å®ç° UI
6. **åˆ›å»ºé¡µé¢**: åœ¨ `src/app/` ä¸­åˆ›å»ºé¡µé¢è·¯ç”±
7. **æµ‹è¯•åŠŸèƒ½**: æœ¬åœ°æµ‹è¯•æ‰€æœ‰æµç¨‹
8. **ä»£ç æ£€æŸ¥**: è¿è¡Œ `pnpm lint` ç¡®ä¿ä»£ç è´¨é‡

#### 3. API å¼€å‘æ¨¡æ¿

```typescript
// src/app/api/[module]/route.ts
import { NextRequest, NextResponse } from 'next/server'
import { apiSuccess, apiFailure } from '@/contracts/types/common'
import { auth } from '@/lib/auth'
import { prisma } from '@/lib/prisma'

export async function GET(req: NextRequest) {
  try {
    // 1. èº«ä»½éªŒè¯
    const session = await auth.api.getSession({ headers: req.headers })
    if (!session?.user) {
      return NextResponse.json(
        apiFailure('UNAUTHORIZED', 'Please login'),
        { status: 401 }
      )
    }

    // 2. å‚æ•°éªŒè¯
    const { searchParams } = new URL(req.url)
    const id = searchParams.get('id')
    if (!id) {
      return NextResponse.json(
        apiFailure('VALIDATION_FAILED', 'Missing id parameter'),
        { status: 400 }
      )
    }

    // 3. ä¸šåŠ¡é€»è¾‘
    const data = await prisma.model.findUnique({
      where: { id }
    })
    if (!data) {
      return NextResponse.json(
        apiFailure('NOT_FOUND', 'Resource not found'),
        { status: 404 }
      )
    }

    // 4. è¿”å›æˆåŠŸå“åº”
    return NextResponse.json(apiSuccess(data))

  } catch (error) {
    console.error('API Error:', error)
    return NextResponse.json(
      apiFailure('INTERNAL_ERROR', 'Internal server error'),
      { status: 500 }
    )
  }
}
```

#### 4. ç»„ä»¶å¼€å‘æ¨¡æ¿

```typescript
// src/components/YourComponent.tsx
'use client'

import { useState, useEffect } from 'react'
import { Button } from '@/components/ui/button'
import { request } from '@/lib/request'
import { toast } from 'sonner'

interface YourComponentProps {
  title: string
  onSuccess?: () => void
}

export function YourComponent({ title, onSuccess }: YourComponentProps) {
  const [loading, setLoading] = useState(false)
  const [data, setData] = useState(null)

  const handleAction = async () => {
    setLoading(true)
    try {
      const result = await request.post('/api/your-endpoint', {
        // request body
      })

      if (result.ok && result.data?.success) {
        toast.success('Action completed successfully')
        onSuccess?.()
      }
    } catch (error) {
      // é”™è¯¯å·²ç”± request å°è£…å¤„ç†
    } finally {
      setLoading(false)
    }
  }

  return (
    <div className="page-container">
      <h1 className="text-2xl font-bold">{title}</h1>
      <Button onClick={handleAction} disabled={loading}>
        {loading ? 'Processing...' : 'Submit'}
      </Button>
    </div>
  )
}
```

#### 5. æ•°æ®åº“æ“ä½œè§„èŒƒ

```bash
# ä¿®æ”¹æ•°æ®åº“æ¨¡å‹å
pnpm dbpush          # æ¨é€åˆ°æ•°æ®åº“å¹¶ç”Ÿæˆå®¢æˆ·ç«¯

# æŸ¥çœ‹æ•°æ®åº“
pnpm dbstudio        # æ‰“å¼€ Prisma Studio GUI

# å¤‡ä»½æ•°æ®åº“
pnpm dbbackup        # å¤‡ä»½å½“å‰æ•°æ®åº“

# å¯¼å‡º/å¯¼å…¥ JSON
pnpm dbexportjson:local   # å¯¼å‡ºæœ¬åœ°æ•°æ®åº“ä¸º JSON
pnpm dbimportjson:local   # ä» JSON å¯¼å…¥åˆ°æœ¬åœ°æ•°æ®åº“
```

**æ•°æ®åº“æŸ¥è¯¢æœ€ä½³å®è·µ**:
```typescript
// âœ… ä½¿ç”¨ select å‡å°‘æ•°æ®ä¼ è¾“
const user = await prisma.user.findUnique({
  where: { id },
  select: {
    id: true,
    name: true,
    email: true,
    // åªé€‰æ‹©éœ€è¦çš„å­—æ®µ
  }
})

// âœ… ä½¿ç”¨ include å…³è”æŸ¥è¯¢
const work = await prisma.work.findUnique({
  where: { id },
  include: {
    creator: {
      select: { id: true, name: true, avatarUrl: true }
    },
    tags: true
  }
})

// âœ… é‚®ç®±æŸ¥è¯¢ç»Ÿä¸€å°å†™
const user = await prisma.user.findUnique({
  where: { email: email.toLowerCase() }
})
```

#### 6. Git æäº¤è§„èŒƒ

éµå¾ª Conventional Commits é£æ ¼:

```bash
# æ ¼å¼: <type>(<scope>): <subject>

# ç±»å‹
feat:      # æ–°åŠŸèƒ½
fix:       # Bug ä¿®å¤
refactor:  # é‡æ„(ä¸æ”¹å˜åŠŸèƒ½)
style:     # æ ·å¼è°ƒæ•´
docs:      # æ–‡æ¡£æ›´æ–°
test:      # æµ‹è¯•ç›¸å…³
chore:     # æ„å»º/å·¥å…·å˜åŠ¨

# ç¤ºä¾‹
git commit -m "feat(auth): æ·»åŠ  Google OAuth ç™»å½•æ”¯æŒ"
git commit -m "fix(upload): ä¿®å¤å¤§æ–‡ä»¶ä¸Šä¼ å¤±è´¥é—®é¢˜"
git commit -m "refactor(api): ç»Ÿä¸€é”™è¯¯å¤„ç†é€»è¾‘"
```

#### 7. ç¯å¢ƒå˜é‡ç®¡ç†

**å¿…éœ€ç¯å¢ƒå˜é‡**:
```env
# æ•°æ®åº“
DATABASE_URL=              # Prisma æ•°æ®åº“è¿æ¥
DIRECT_URL=                # ç›´è¿ URL (ç”¨äºè¿ç§»)

# è®¤è¯
BETTER_AUTH_SECRET=        # Better Auth å¯†é’¥
BETTER_AUTH_URL=           # è®¤è¯æœåŠ¡ URL

# Supabase
NEXT_PUBLIC_SUPABASE_URL=
NEXT_PUBLIC_SUPABASE_ANON_KEY=
SUPABASE_SERVICE_ROLE_KEY=

# é‚®ä»¶æœåŠ¡
RESEND_API_KEY=            # Resend é‚®ä»¶æœåŠ¡

# è§†é¢‘å¤„ç†
MUX_TOKEN_ID=              # Mux ä»¤ç‰Œ ID
MUX_TOKEN_SECRET=          # Mux ä»¤ç‰Œå¯†é’¥

# ç›‘æ§ (å¯é€‰)
NEXT_PUBLIC_ENABLE_SENTRY= # true/false å¼ºåˆ¶å¼€å…³
SENTRY_DSN=                # Sentry é¡¹ç›® DSN
```

#### 8. å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

**é—®é¢˜ 1: Prisma Client æœªç”Ÿæˆ**
```bash
pnpm dbgen
```

**é—®é¢˜ 2: ç«¯å£è¢«å ç”¨**
```bash
# Windows
netstat -ano | findstr :3000
taskkill /PID <PID> /F

# macOS/Linux
lsof -ti:3000 | xargs kill -9
```

**é—®é¢˜ 3: ä¾èµ–å®‰è£…å¤±è´¥**
```bash
# æ¸…ç†ç¼“å­˜é‡æ–°å®‰è£…
rm -rf node_modules pnpm-lock.yaml
pnpm install
```

**é—®é¢˜ 4: TypeScript ç±»å‹é”™è¯¯**
```bash
# é‡æ–°ç”Ÿæˆç±»å‹
pnpm dbgen
# é‡å¯ TypeScript æœåŠ¡å™¨ (VS Code: Cmd/Ctrl + Shift + P â†’ Restart TS Server)
```

### ğŸš€ éƒ¨ç½²

åº”ç”¨ç¨‹åºé…ç½®ä¸ºåœ¨ Vercelã€Netlify æˆ–ç±»ä¼¼çš„ Next.js å…¼å®¹æ‰˜ç®¡æœåŠ¡ä¸Šéƒ¨ç½²ã€‚

**éƒ¨ç½²å‰æ£€æŸ¥æ¸…å•**:
- [ ] æ‰€æœ‰ç¯å¢ƒå˜é‡å·²é…ç½®
- [ ] æ•°æ®åº“è¿ç§»å·²åº”ç”¨ (`pnpm dbpush`)
- [ ] æ„å»ºæˆåŠŸ (`pnpm build`)
- [ ] Sentry é…ç½®æ­£ç¡® (org: `yellowpoint`)
- [ ] å…è®¸çš„å›¾ç‰‡åŸŸåå·²åœ¨ [next.config.mjs](next.config.mjs) ä¸­é…ç½®
